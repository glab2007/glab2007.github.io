<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru">

<head>
<title>Операторы языка MapBasic &frasl;GLab&copy;2007&frasl;</title>

<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta http-equiv="content-type" content="text/css; charset=utf-8" />
<meta name="Author" content="GLab&copy;2007 http://www.glab2007.narod.ru" />
<meta name="Description" content="Описание операторов и функций MapBasic. Примеры использования их в MapInfo при создании SQL-запросов, обновлении таблиц и редактировании рабочих наборов на сайте проекта GLab&copy;2007." />
<meta name="KeyWords" content="операторы и функции mapbasic, sql-запросы mapinfo" />

<link rel="shortcut icon" href="../i/favicon.ico" type="image/x-icon" />
<link rel="icon" href="../i/favicon.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" href="../style.css" />

<script src="https://yastatic.net/es5-shims/0.0.2/es5-shims.min.js" charset="utf-8"></script>
<script src="https://yastatic.net/share2/share.js" async="async" charset="utf-8"></script>
<script type="text/javascript" src="../scripts.js"></script>

</head>
<body>

<div id="left">
	<ul>
		<li class="home"><a href="../main.html" title="На главную">На <br />главную</a></li>
		<li class="news"><a href="../index.html" title="Новости" style="line-height: 36px; ">Новости</a></li>
		<li class="query"><a href="../query.html" title="Топ запросов">Топ<br />запросов</a></li>
		<li class="article"><a id="item" href="../article.html" title="Статьи" style="line-height: 36px; ">Статьи</a></li>
		<li class="download"><a href="../download.html" title="Загрузка" style="line-height: 36px; ">Загрузка</a></li>
		<li class="links"><a href="../links.html" title="Ссылки">Каталог<br />ссылок</a></li>
		<li class="about"><a href="../about.html" title="О проекте">О<br />проекте</a></li>
		<li class="contact"><a href="../contact.html" title="Контактная информация" style="line-height: 36px; ">Контакты</a></li>
		<li class="search"><a href="../main.html#search" title="Поиск">Поиск<br />по сайту</a></li>
		<li class="map"><a href="../map.html" title="Карта сайта">Карта<br />сайта</a></li>
	</ul>
</div>
<div id="arrow">
	<a href="#">
		<img src="../i/arr.gif" alt="Вверх" />
	</a>
</div>
<div class="ya-share2" data-services="vkontakte,facebook,linkedin,viber"></div>

<div id="top"></div>

<div id="border_left"><div id="border_right"><div id="border_top"><div id="border_bottom">
	<div id="content">

		<h1 class="article">
			Операторы языка MapBasic
		</h1>
		<hr class="split" />

		<div class="avatar">
			<a href="http://www.karasoft.ru" title="KARASOFT Design"><img class="inline" src="opmb/0.png" alt="KARASOFT Design" width="50px; " height="50px; " /></a>
		</div>
		<p class="small">
			Автор: <a href="mailto:mail@karasoft.ru">Андрей Карасов</a>
		</p>
		<p class="small">
			Перед вами статья из цикла &laquo;Геостатьи&raquo;, опубликованных на сайте Андрея Карасова <a href="http://www.karasoft.ru" title="Перейти">KARASOFT Design</a>. В этой статье приводится подробное описание операторов и функций внутреннего языка MapInfo &ndash; MapBasic. Особенность этих операторов состоит в том, что их можно использовать непосредственно в самой MapInfo: при создании SQL-запросов, обновлении таблиц и выборок, редактировании рабочих наборов и т.д.
		</p>
		<hr class="split" />

		<ul id="toc">
			<li><a href="#ch1">От автора</a></li>
			<li><a href="#ch2">Описание операторов языка MapBasic</a></li>
			<li><a href="#ch3">Математические операторы в выражениях</a></li>
			<li><a href="#ch4">Строковые операторы в выражениях</a></li>
			<li><a href="#ch5">Операторы сравнения в выражениях</a></li>
			<li><a href="#ch6">Логические операторы в выражениях</a></li>
		</ul>
		<hr class="split" />

<!--1-->
		<h2 id="ch1">От автора</h2>
		<p>
			Для написания данного цикла статей послужили достаточно частые обращения моих коллег, обычных, так скажем, пользователей MapInfo Professional, весьма далеких от программирования. Я попробую более-менее популярно приоткрыть некоторые секреты, благодаря которым рядовые пользователи смогут построить свою работу более эффективно. Для разбора выбрана MapInfo, т.к., данная система содержит достаточно много стандартных средств для создания всевозможных выборок графических и семантических данных, а также богатый инструментарий для изменения значений семантических полей в таблицах электронных карт. Именно на подобные просьбы часто приходится откликаться. (&hellip;)
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--2-->
		<h2 id="ch2">Описание операторов языка MapBasic для производства выборок данных в таблицах MapInfo</h2>
		<p>
			Сразу скажу, что поскольку занялись мы программированием, то существуют определенные правила и соглашения использования в выражениях строковых констант, чисел и дат.
		</p>
		<p>
			<b>Символьные строки</b><br />
			Символьные константы в выражении заключаются в кавычки. Если строка не заключена в кавычки, то MapInfo Professional будет воспринимать её как имя поля (колонки). Например, строки 1 и 2 &ndash; константы, а строки 3 и 4 &ndash; нет:
		</p>
		<ol>
			<li>&quot;Красное&quot;</li>
			<li>&quot;Красноярск&quot;</li>
			<li>Красное</li>
			<li>New York</li>
		</ol>
		<p>
			<b>Числа в выражениях</b><br />
			Для задания чисел в выражениях не используйте запятую, знак доллара и другие знаки, не являющиеся цифрами, точкой и знаком минус для отрицательных чисел. Для задания числовых величин в экспоненциальном виде может также использоваться символ E.
		</p>
		<p>
			<b>Даты в выражениях</b><br />
			Дата состоит из месяца дня и года (последнее необязательно). Год может задаваться двумя или четырьмя цифрами. Значения месяца, дня и года разделяются либо знаком дефиса, либо косой чертой. Сама дата заключается в кавычки. Если год в дате не задан, то понимается, что эта дата текущего года.
		</p>
		<p>
			Для описания операторов и функций MapBasic, используемых в диалогах выборок, воспользуемся справочными данными языка и немного перегруппируем списки команд.
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--3-->
		<h2 id="ch3">Математические операторы в выражениях</h2>
		<p>
			Математические операторы часто используются в выражениях. Следующая таблица представляет символы операторов, имена, примеры и правила преобразование типов значений.
		</p>
		<table border="1px">
			<tr>
				<td><b>Символ</b></td>
				<td><b>Описание</b></td>
				<td><b>Пример</b></td>
				<td><b>Подробнее о примере</b></td>
			</tr>
			<tr>
				<td>+</td>
				<td>сложение</td>
				<td>A + B </td>
				<td>дата + число = дата<br /><i>04/01/2007 + 4: 04/05/2007</i><br />вещественное + дата = дата<br /><i>4 + 232: 236</i></td>
			</tr>
			<tr>
				<td>- </td>
				<td>вычитание</td>
				<td>A - B (вычитание)<br />-A (отрицательное)</td>
				<td>дата - число = дата<br />число - дата = дата<br /><i>236 - 4 = 232</i><br />любое число - любое число = вещественное число</td>
			</tr>
			<tr>
				<td>* </td>
				<td>умножение </td>
				<td>A * B</td>
				<td>любое число * любое целое = целое<br />любое число * любое число = вещественное число</td>
			</tr>
			<tr>
				<td>/ </td>
				<td>деление</td>
				<td>A / B</td>
				<td>любое число / любое число = вещественное число</td>
			</tr>
			<tr>
				<td>^ </td>
				<td>возведение в степень </td>
				<td>A ^ B </td>
				<td>любое число ^ любое число = вещественное число</td>
			</tr>
		</table>
		<p>
			Разрешаются следующие виды вычислений:
		</p>
		<ul>
			<li>
				Сложение чисел с датами с получением новой даты;
			</li>
			<li>
				Вычитание чисел из дат с получением новой даты;
			</li>
			<li>
				Вычитание даты из даты с получением числа.
			</li>
		</ul>
		<p>
			При прибавлении чисел к датам или вычитании чисел из дат, MapInfo считает число, определённым количеством дней. Так, для вычитания или прибавления недели надо использовать число 7, если необходимо прибавить или вычесть месяц, следует использовать 30 или 31. Когда MapInfo Professional вычитает дату из даты, в результате получится количество дней.
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--4-->
		<h2 id="ch4">Использование строковых операторов в выражениях</h2>
		<table border="1px">
			<tr>
				<td>+</td>
				<td>&laquo;конкатенация&raquo; &ndash; объединение строк и строковых выражений.</td>
			</tr>
			<tr>
				<td>&amp;</td>
				<td>(может использоваться если предваряется пробелом)</td>
			</tr>
		</table>
		<p>
			Помните, что строки должны быть заключены в двойные кавычки.
		</p>
		<p class="code">
	&quot;Здравствуй, &quot; + &quot;мир.&quot; дает &quot;Здравствуй, мир.&quot;
	&quot;4&quot;+&quot;5&quot; даёт &quot;45&quot;
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--5-->
		<h2 id="ch5">Использование операторов сравнения в выражениях</h2>
		<table border="1px">
			<tr>
				<td><b>Операторы</b></td>
				<td><b>Описание</b></td>
			</tr>
			<tr>
				<td>=</td>
				<td>&laquo;равенство&raquo;</td>
			</tr>
			<tr>
				<td>&lt;&gt;</td>
				<td>&laquo;неравенство&raquo;</td>
			</tr>
			<tr>
				<td>&gt;</td>
				<td>&laquo;больше&raquo;</td>
			</tr>
			<tr>
				<td>&lt;</td>
				<td>&laquo;меньше&raquo;</td>
			</tr>
			<tr>
				<td>&gt;=</td>
				<td>&laquo;больше или равно&raquo;</td>
			</tr>
			<tr>
				<td>&lt;=</td>
				<td>&laquo;меньше или равно&raquo;</td>
			</tr>
		</table>
		<p>
			<b>Сравнение чисел</b><br />
			Численное сравнение основано на численных значениях выражений и численных констант.
		</p>
		<p>
			<b>Пример</b>: выбрать все строки, в которых доход больше $65,000:
		</p>
		<p class="code">
	HH_INC&nbsp;&gt;&nbsp;65000
		</p>
		<p class="small passage">
			Комментарий: Не добавляйте знак доллара или запятую. MapInfo Professional не знает что делать с этим и Вы получите сообщение об ошибке.
		</p>
		<p>
			<b>Пример</b>: покажите все районы, где средний возраст населения составляет 42 года:
		</p>
		<p class="code">
	MED_AGE&nbsp;=&nbsp;42
		</p>
		<p class="small passage">
			Комментарий: Это выражение выбирает только те записи, где средний возраст ровно 42 года. Когда колонка со средним возрастом содержит десятичную точку (как в случае демографических данных поставляемых в комплекте с MapInfo Professional), то маловероятно, что найдётся много регионов, где средний возраст будет равен ровно 42.
		</p>
		<p>
			Следующее выражение даёт лучший результат:
		</p>
		<p class="code">
	Round(MED_AGE, 1) = 42
		</p>
		<p class="small passage">
			Комментарий: Функция &quot;round (любое число, любое число)&quot; округляет первое число, с точностью до второго числа. В этом примере первое число это средний возраст (MED_AGE), а второе это 1, указывающее что средний возраст должен быть округлён до ближайшего целого числа.
		</p>
		<p>
			<b>Пример</b>: Все строки, где значение не равно $23,000.
		</p>
		<p class="code">
	AMOUNT&nbsp;&lt;&gt;&nbsp;23000
		</p>
		<p class="small passage">
			Комментарий: Вы можете использовать функцию Round, с параметром округления 10, если не преследуете цель получить значение, точно равное 23000.
		</p>
		<p>
			<b>Сравнение строк.</b>
		</p>
		<p>
			Сравнение строк основано на точном соответствии символов содержащихся в строке. В случае &laquo;&gt;&raquo; это обозначает &laquo;дальше в алфавите&raquo; и &laquo;&lt;&raquo; обозначает &laquo;раньше в алфавите&raquo;.
		</p>
		<p>
			Когда вводите строку в выражении заключайте её в кавычки, для того чтобы MapInfo Professional рассматривало её как строку, а не как название колонки.
		</p>
		<p>
			<b>Пример</b>: Все строки, где продавец Acme.
		</p>
		<p class="code">
	VENDOR = &quot;Acme&quot;
		</p>
		<p class="small passage">
			Комментарий: обратите внимание, что строка Acme заключена в кавычки, для того чтобы MapInfo Professional рассматривало её как символьную строку, а не искало колонку с названием Acme.
		</p>
		<p>
			<b>Пример</b>: Все строки, где продавец не Acme.
		</p>
		<p class="code">
	VENDOR = &quot;&lt;&gt;&quot;
		</p>
		<p>
			<b>Сравнение дат.</b>
		</p>
		<p>
			<b>Пример</b>: Все сообщения принятые 9 октября, 1991.
		</p>
		<p class="code">
	RECEIVED = &quot;10-9-91&quot;
		</p>
		<p class="small">
			Примечание: Имейте ввиду:
		</p>
		<ul class="small">
			<li>Дата заключается в кавычки;</li>
			<li>Дата записывается в форме: месяц, день, год;</li>
			<li>Числа в дате разделяются дефисом или косой чертой (/);</li>
			<li>Для года было использовано два символа. Но можно использовать и четыре символа (1991).</li>
		</ul>
		<p>
			<b>Пример</b>: Все сообщения принятые после 9 октября, 1991.
		</p>
		<p class="code">
	RECEIVED &gt; &quot;10-9-91&quot;
		</p>
		<p class="small passage">
			Комментарий: Это выражение не выберет записи с сообщениями принятыми 9 октября, 1991. Если Вы хотите чтобы были выбраны и они:
		</p>
		<p class="code">
	RECEIVED &gt; = &quot;10-9-91&quot;
		</p>
		<p>
			<b>Пример</b>: Записи с сообщениями принятыми до Августа.
		</p>
		<p class="code">
	Month(RECEIVED) &lt; 8
		</p>
		<p class="small passage">
			Комментарий: Это выражение использует функцию Month чтобы извлечь месяц из даты. Конкретный год не указывается. Если база данных содержит записи за несколько лет, это выражение не будет принимать во внимание год.
		</p>
		<p>
			<b>Логическое сравнение.</b>
		</p>
		<p>
			<b>Пример</b>: Всё что продано.
		</p>
		<p class="code">
	Shipped
		</p>
		<p class="small passage">
			Комментарий: Колонка &laquo;Shipped&raquo; &ndash; логическая. Она содержит &laquo;T&raquo; если значение истинное, в противном случае &laquo;F&raquo; &ndash; ложное. Когда товар продан, он помечается &laquo;T&raquo;. В противном случае он не продан. Для проданных товаров выражение из примера ищет значение истина. Для непроданных &ndash; значение ложь.
		</p>
		<p>
			<b>Пример</b>: Всё что не продано.
		</p>
		<p class="code">
	Str$(Shipped) = &laquo;F&raquo;
	Not Shipped
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--6-->
		<h2 id="ch6">Логические операторы в выражениях</h2>
		<p>
			&laquo;And&raquo; (И), &laquo;or&raquo; (ИЛИ) и &laquo;not&raquo; (НЕ) - это логические операторы. MapInfo Professional рассматривает каждое такое выражение как проверку и применяет к каждой записи в таблице. Результатом каждой проверки является ответ &laquo;да&raquo; или &laquo;нет&raquo; (т.е. &laquo;истина&raquo; или &laquo;ложь&raquo;). Комбинируя результаты проверки каждого условия с помощью логических операторов, MapInfo Professional выдает общий ответ: удовлетворяет ли данная запись условию выбора. 
		</p>
		<table border="1px">
			<tr>
				<td><b>Оператор</b></td>
				<td><b>Описание</b></td>
			</tr>
			<tr>
				<td>AND</td>
				<td>Принимает значение &laquo;истина&raquo; только в том случае, если оба ее аргумента (логические выражения) истинны. То есть запись должны удовлетворять обоим условиям, чтобы попасть в выборку. </td>
			</tr>
			<tr>
				<td>OR</td>
				<td>Принимает значение &laquo;истина&raquo; если один или оба ее аргумента (логические выражения) истинны. То есть запись должны удовлетворять хотя бы одному из условий, чтобы попасть в выборку. Записи также выбираются, если удовлетворяют обоим условиям.</td>
			</tr>
			<tr>
				<td>NOT</td>
				<td>Принимает значение &laquo;истина&raquo;, если аргумент имеет значение &laquo;ложь&raquo;. То есть записи не должны удовлетворять условию, чтобы попасть в выборку.</td>
			</tr>
		</table>
		<p>
			Предположим, Вы хотите выбрать дома стоимостью от $250,000 или больше, находящиеся в графстве Колумбия. Каждая запись должна отвечать двум критериям, каждый из которых может быть определён как простое выражение:
		</p>
		<p class="code">
	VALUE &gt;= 250000
	COUNTY = &quot;Columbia&quot;
		</p>
		<p>
			Сначала Вы можете сделать выборку всех домов, которые стоят от 250,000 и более. Затем сделать новую выборку из этой выборки, отобрав дома которые находятся в графстве Колумбия. Однако, проще объединить два эти оператора в одно выражения, используя логический оператор &laquo;and&raquo;:
		</p>
		<p>
			1. <span class="code">COUNTY = &quot;Columbia&quot; and VALUE >= 250000</span>
		</p>
		<p>
			MapInfo Professional проверяет запись на соответствие условию заданному в выражении, для этого делается две проверки: Действительно ли в поле COUNTY значение Columbia? Является ли значение в поле VALUE больше или равным 250000? Если ответ на оба эти вопроса истина (т.е. ДА), значит, запись попадает в текущую выборку. Если ответ на один или оба вопроса - НЕТ (т.е. ложь), запись не добавляется к выборке.
		</p>
		<p>
			Теперь, допустим, Вы ищете недвижимость стоимостью от $250,000 и находящуюся где угодно, только не в графстве Columbia? Вы можете использовать оператор "not" чтобы обратить значение первой части прошлого выражения, превратив его в выражение:
		</p>
		<p class="code">
	not (COUNTY = &quot;Columbia&quot;) and VALUE>=250000
		</p>
		<p>
			Только те записи, в которых графство не Columbia будут удовлетворять требованиям первой части выражения.
		</p>
		<p>
			2. <span class="code">not (COUNTY = &quot;Columbia&quot; and VALUE>=250000)</span>
		</p>
		<p>
			Выражение 2 это отрицание для выражения 1. Любая запись, удовлетворяющая выражению 1 не удовлетворяет выражение 2. Любая запись, не удовлетворяющая выражению 1 удовлетворят выражение 2.
		</p>
		<p>
			Вы можете использовать &laquo;or&raquo; когда хотите указать альтернативные условия, например: 
		</p>
		<p class="code">
	TOTAL_AREA &gt; 40 or VALUE &gt; 250000
		</p>
		<p>
			Это условие отбирает записи, в которых площадь больше 40 или стоимость больше 250000. Если запись отвечает хоть одному из этих условий, она помещается в выборку. Будьте внимательны при построении выражений с использованием логических операторов.
		</p>
		<p>
			Следующее выражение выглядит нормально, однако работать корректно оно не будет:
		</p>
		<p>
			3. <span class="code">COUNTY = &quot;Columbia&quot; or &quot;Greene&quot;</span>
		</p>
		<p>
			Оценивая это выражение как английскую фразу-ГРАФСТВО равно Колумбия или Грин - мы можем предположить, что это выражение будет работать так же как выражение 3 и выбрать все записи, где встречается графство Columbia или графство Greene. Но правила вычислительной логики несколько отличаются от правил английского языка.
		</p>
		<p>
			<b>Численные значения в выражениях.</b>
		</p>
		<p>
			<b>Пример</b>: Все домовладения, доход которых выше $65,000 и средний возраст 42.
		</p>
		<p class="code">
	HH_INC &gt;= 65000 and Round(MED_AGE, 1) = 42
		</p>
		<p class="small passage">
			Комментарий: это выражение состоит из двух частей. Части соединены оператором &laquo;and&raquo;, это означает, что обе части выражения должны быть истинными, для того чтобы запись была выбрана.
		</p>
		<p>
			<b>Пример</b>: выбрать все записи, у которых цена между $50,000 и $100,000.
		</p>
		<p>
			4. <span class="code">PRICE &gt;= 50000 and PRICE &lt;= 100000</span>
		</p>
		<p class="small passage">
			Комментарий: теперь мы устанавливаем два условия, которым должны отвечать записи, для того чтобы быть выбранными. Используя, операторы &laquo;больше или равно&raquo; (&gt;=) и &laquo;меньше или равно&raquo; (&lt;=) мы включаем в выборку записи, у которых значение точно равно указанным $50,000 и $100,000. Если мы укажем просто &laquo;больше чем&raquo; (&gt;) и &laquo;меньше чем&raquo; (&lt;), выражение выберет записи от $50,001 до $99,999 но не включит $50,000 или $100,000.
		</p>
		<p>
			<b>Пример:</b> выбрать записи с ценами от $50,000 до $100,000 или от $150,000 до $200,000.
		</p>
		<p>
			5. <span class="code">(PRICE &gt;= 50000 and PRICE &lt;= 100000) or (PRICE &gt;= 150000 and PRICE &lt;= 200000)</span>
		</p>
		<p class="small passage">
			Комментарий: общий вид выражения: (expression1) or (expression2). Каждое из этих выражений имеет тот же вид что и выражение 4. Когда строка отвечает условию, указанному в любом из этих выражений expression1 или expression2, MapInfo Professional поместит эту строку в выборку.
		</p>
		<p>
			<b>Строки в выражениях.</b>
		</p>
		<p>
			<b>Пример</b>: выбрать всех клиентов от N до Q.
		</p>
		<p class="code">
	LAST_NAME &gt;= &quot;N&quot; and LAST_NAME &lt; &quot;R&quot;
		</p>
		<p class="small passage">
			Комментарий: первая часть выражения ищет фамилии, начинающиеся на букву &laquo;n&raquo; или расположены в алфавите после (дальше) &laquo;n&raquo;. Вторая часть выражения проверяет фамилии, которые начинаются с буквы, которая в алфавите расположена раньше (до) буквы &laquo;r&raquo;. Любая фамилия, начинающаяся от &laquo;n&raquo; до &laquo;q&raquo; удовлетворяет условию.
		</p>
		<p>
			<b>Пример</b>: выбрать всех клиентов от N до Z.<br />
			<span class="small">Примечание: Операторы сравнения строк в MapInfo Professional не чувствительны к регистру.</span>
		</p>
		<p class="code">
	LAST_NAME &gt;= &quot;N&quot;
		</p>
		<p class="samll passage">
			Комментарий: так как &laquo;z&raquo; последняя буква в алфавите, то дополнительной проверки не требуется. Не может быть клиентов, фамилия у которых начинается с некой буквы следующей за буквой &laquo;z&raquo;.
		</p>
		<p>
			<b>Пример</b>: все клиенты, фамилия которых начинается на C.
		</p>
		<p class="code">
	LAST_NAME &gt;= &quot;C&quot; and LAST_NAME &lt; &quot;D&quot;
		</p>
		<p>
			<b>Пример</b>: выбрать всех клиентов, фамилии которых между &laquo;Ce&hellip;&raquo; и &laquo;Cn&hellip;&raquo;
		</p>
		<p class="code">
	LAST_NAME &gt;= &quot;CE&quot; and LAST_NAME &lt;&quot;CO&quot;
		</p>
		<p>
			<b>Пример</b>: выбрать всех кто не из Техаса.
		</p>
		<p class="code">
	not STATE = &quot;TX&quot;
		</p>
		<p class="small passage">
			Комментарий: в этом выражении MapInfo Professional будет проверять содержимое колонки STATE. Если содержимое в этой колонке отличается от &laquo;TX&raquo;, запись будет выбрана.
		</p>
		<p>
			<b>Даты в выражениях.</b>
		</p>
		<p>
			<b>Пример</b>: выбрать все записи с датой Август 1990.
		</p>
		<p class="code">
	Month(RECEIVED) = 8 and Year(RECEIVED) = 1990
		</p>
		<p class="small passage">
			Комментарий: в этом выражении мы указываем год явно, используя функцию &laquo;year()&raquo; чтобы извлечь год из даты.
		</p>
		<p class="code">
	RECEIVED &gt;= &quot;01.08.90&quot; and RECEIVED &lt;= &quot;31.08.90&quot;
		</p>
		<p class="small passage">
			Комментарий: в этом выражении мы явно не запрашиваем месяц и год. Вместо этого мы создали фразу, которая на английском звучит так: все записи с датой 1 августа 1990 и позднее и с датой до 31 августа 1990 включительно. Оба выражения дают одинаковый результат, но сформулированы запросы по-разному.
		</p>
		<p>
			<b>Пример</b>: выбрать записи в которых дата июль или сентябрь.
		</p>
		<p class="code">
	Month(RECEIVED) = 7 or Month(RECEIVED) = 9
		</p>
		<p class="small passage">
			Комментарий: как и в предыдущем примере, год не учитывается. В зависимости от данных в таблице и Вашей цели это может быть или не быть проблемой.
		</p>
		<p>
			Если вы хотите указать год:
		</p>
		<p>
			<b>Пример</b>: выбрать записи, в которых дата июль или сентябрь 1989 года
		</p>
		<p class="code">
	month(RECEIVED) = any(7, 9) and year(RECEIVED) = 89
		</p>
		<p class="small passage">
			Комментарий: первая часть этого выражения использует ключевое слово &laquo;any&raquo;. Первая часть выражения будет отвечать условиям, если будет совпадение со значениями указанными в скобках, в данном случае это месяцы июль и сентябрь.
		</p>
		<p>
			<b>Ключевые слова в выражениях.</b>
		</p>
		<p>
			В MapInfo Professional можно использовать специальные зарезервированные слова &laquo;any&raquo;, &laquo;all&raquo;, &laquo;in&raquo; и &laquo;between&raquo;. При задании выражений эти ключевые, зарезервированные слова надо набирать с клавиатуры.
		</p>
		<p>
			Слово &laquo;any&raquo; обозначает выбор любого из элементов множества.
		</p>
		<p>
			6. <span class="code">ABBR = any(&quot;AL&quot;, &quot;MN&quot;, &laquo;TX&raquo;)</span>
		</p>
		<p>
			Выражение будет истинным для любой записи, у которой штат Alabama, Minnesota, или Texas.
		</p>
		<p>
			Чтобы понять значение &laquo;all&raquo;, рассмотрим пример:
		</p>
		<p class="code">
	ABBR &lt;&gt; all(&quot;AL&quot;, &quot;MN&quot;, &laquo;TX&raquo;)
		</p>
		<p>
			Это выражение означает: выбрать все записи, для которых штат не равен Алабама, Миннесота или Техас. Будут выбраны все записи, кроме записей для Алабама, Миннесота или Техас. Посмотрим что получится если мы используем выражение:
		</p>
		<p class="code">
	ABBR &lt;&gt; any(&quot;AL&quot;, &quot;MN&quot;, &laquo;TX&raquo;)
		</p>
		<p>
			Заказы из Алабамы будут выбраны, так как они не из Миннесоты или Техаса, и записи из Миннесоты и Техаса будут выбраны по той же причине.
		</p>
		<p>
			Этот пример показывает использование ключевого слова &laquo;in&raquo;:
		</p>
		<p class="code">
	ABBR in(&quot;AL&quot;, &quot;MN&quot;, &laquo;TX&raquo;)
		</p>
		<p>
			Результат будет такой же как и в выражении 6.<br />
			В данном случае зарезервированное слово &laquo;in&raquo; эквивалентно &laquo;=any&raquo;, а &laquo;not in&raquo; &ndash; &laquo;&lt;&gt;all&raquo;.
		</p>
		<p>
			И наконец, рассмотрим выражения 7 и 8 в которых иллюстрируется применение &laquo;between&raquo;:
		</p>
		<p>
			7. <span class="code">ЦЕНА between 50000 and 100000</span>
		</p>
		<p>
			8. <span class="code">(ЦЕНА between 50000 and 100000) or (ЦЕНА between 150000 and 200000)</span>
		</p>
		<p>
			Это эквиваленты выражений 4 и 5 соответственно. Вы также можете использовать between с символьными строками.
		</p>
		<hr class="split" />

		<h2 id="ch7">Географические операторы в выражениях</h2>
		<p>
			В MapInfo Professional имеется несколько географических операторов. Они используются для выбора объектов на основании их взаимного расположения в пространстве. С географическими операторами в MapInfo Professional используется специальное зарезервированное слово: &laquo;obj&raquo; или &laquo;object&raquo;. Оно определяет, что MapInfo Professional должно вычислить значение на основании графических объектов, а не соответствующих им табличных данных.
		</p>
		<p>
			Имя географического оператора указывается между географическими объектами. Выбрать его можно в списке &laquo;Операторы&raquo; в диалоге &laquo;SQL-запрос&raquo;. Здесь перечислены географические операторы:
		</p>
		<table border="1px">
			<tr>
				<td>Contains</td>
				<td>Объект A содержит объект В, если центроид объекта В лежит в границах объекта A.</td>
			</tr>
			<tr>
				<td>Contains Entire</td>
				<td>Объект A полностью содержит объект В, если границы объекта В полностью лежат внутри границ объекта A.</td>
			</tr>
			<tr>
				<td>Within</td>
				<td>Объект A находится внутри объекта В, если его центроид находится в границах объекта В.</td>
			</tr>
			<tr>
				<td>Entirely Within</td>
				<td>Объект A находится полностью внутри объекта В, если его граница полностью находится внутри границ объекта В.</td>
			</tr>
			<tr>
				<td>Intersects</td>
				<td>Объект A пересекается с объектом В, если они имеют хотя бы одну общую точку. </td>
			</tr>
		</table>
		<p>
			&laquo;Contains&raquo; и &laquo;Within&raquo; имеют дело с центроидами.
		</p>
		<p>
			&laquo;Contains Entire&raquo; и &laquo;Entirely Within&raquo; имеют дело с границами и не затрагивают центроиды.
		</p>
		<p>
			Также, полилинии не могут содержать (contain) точку, но они могут пересекать (intersect) точку; точка не может быть внутри (within) полилинии, но может пересекать (intersect) полилинию.
		</p>
		<p class="small">
			Примечание: При этом следует помнить, что MapInfo Professional выполняет простые операции &laquo;Содержит&raquo; (Contains) и &laquo;Внутри&raquo; (Within) гораздо быстрее, чем &laquo;Содержит полностью&raquo; (Contains Entire) и Полностью внутри (Entirely Within). Поэтому, если Вам не обязательно точно знать, полностью ли один объект содержит другой, используйте Contains и Within вместо Contains Entire и Entirely Within.
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

		<p class="small">
			Оригинал:<br />
			<a href="http://www.karasoft.ru/dinapage.php?index=126638969762402" title="Перейти">Геостатьи</a>
		</p>
		<hr class="split" />

	</div>
</div></div></div></div>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
	(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
	m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
	(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
 
	ym(86922484, "init", {
		 clickmap:true,
		 trackLinks:true,
		 accurateTrackBounce:true
	});
 </script>
 <noscript><div><img src="https://mc.yandex.ru/watch/86922484" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
 <!-- /Yandex.Metrika counter -->

</body>
</html>