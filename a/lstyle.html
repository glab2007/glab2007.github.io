<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru">

<head>
<title>Редактирование стилей линий MapInfo: Программа Line Style Editor &frasl;GLab&copy;2007&frasl;</title>

<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta http-equiv="content-type" content="text/css; charset=utf-8" />
<meta name="Author" content="GLab&copy;2007 http://www.glab2007.narod.ru" />
<meta name="Description" content="Создание и изменение стилей линий MapInfo. Редактирование файла mapinfow.pen в программе MILISTED. Описание работы и практические примеры на сайте проекта GLab&copy;2007." />
<meta name="KeyWords" content="стили линий mapinfo, line style editor, mapinfow.pen" />

<link rel="shortcut icon" href="../i/favicon.ico" type="image/x-icon" />
<link rel="icon" href="../i/favicon.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" href="../style.css" />

<script src="https://yastatic.net/es5-shims/0.0.2/es5-shims.min.js" charset="utf-8"></script>
<script src="https://yastatic.net/share2/share.js" async="async" charset="utf-8"></script>
<script type="text/javascript" src="../scripts.js"></script>

</head>
<body>

<div id="left">
	<ul>
		<li class="home"><a href="../main.html" title="На главную">На <br />главную</a></li>
		<li class="news"><a href="../index.html" title="Новости" style="line-height: 36px; ">Новости</a></li>
		<li class="query"><a href="../query.html" title="Топ запросов">Топ<br />запросов</a></li>
		<li class="article"><a id="item" href="../article.html" title="Статьи" style="line-height: 36px; ">Статьи</a></li>
		<li class="download"><a href="../download.html" title="Загрузка" style="line-height: 36px; ">Загрузка</a></li>
		<li class="links"><a href="../links.html" title="Ссылки">Каталог<br />ссылок</a></li>
		<li class="about"><a href="../about.html" title="О проекте">О<br />проекте</a></li>
		<li class="contact"><a href="../contact.html" title="Контактная информация" style="line-height: 36px; ">Контакты</a></li>
		<li class="search"><a href="../main.html#search" title="Поиск">Поиск<br />по сайту</a></li>
		<li class="map"><a href="../map.html" title="Карта сайта">Карта<br />сайта</a></li>
	</ul>
</div>
<div id="arrow">
	<a href="#">
		<img src="../i/arr.gif" alt="Вверх" />
	</a>
</div>
<div class="ya-share2" data-services="vkontakte,facebook,linkedin,viber"></div>

<div id="top"></div>

<div id="border_left"><div id="border_right"><div id="border_top"><div id="border_bottom">
	<div id="content">

		<h1 class="article">
			Редактирование стилей линий MapInfo. Программа Line Style Editor (MILISTED)
		</h1>
		<hr class="split" />

<!--0-->
		<ul id="toc">
			<li><a href="#ch1">Введение</a></li>
			<li><a href="#ch2">Стили линий MapInfo</a></li>
			<li><a href="#ch3">Программа MILISTED</a></li>
			<li><a href="#ch4">Меры предосторожности</a></li>
			<li><a href="#ch5">Начало работы</a></li>
			<li><a href="#ch6">Обзор инструментов</a></li>
			<li><a href="#ch7">Основные операции</a></li>
			<li><a href="#ch8">Работа со слоями</a></li>
			<li><a href="#ch9">Работа с объектами</a></li>
			<li><a href="#ch10">Инвариантность результатов</a></li>
			<li><a href="#ch11">Соблюдение размеров</a></li>
			<li><a href="#ch12">Практические примеры</a></li>
			<li><a href="#ch13">Список использованной литературы</a></li>
		</ul>
		<hr class="split" />

<!--1-->
		<h2 id="ch1">Введение</h2>
		<p>
			Каждый из нас, наверное, хоть раз в жизни сталкивался с такой неприятной ситуацией, как попавший в обувь камешек. И, вроде бы, ничего серьезного нет, ходить, в принципе, можно. Но попадает под ногу в самый неподходящий момент и, в целом, жизнь отравляет.
		</p>
		<p>
			Судя по многочисленным жалобам, для пользователей MapInfo таким &laquo;камешком&raquo; уже много лет являются крайне скудные, если не сказать убогие, средства оформления графических материалов. Да, конечно, это не программа для подготовки карт к печати, это ГИС для бизнеса (а изначально вообще &ndash; программа навигации для школьных автобусов). Её чуть ли не основная задача &ndash; продемонстрировать совету директоров, как выросли продажи по округам. Но реальность отечественного рынка такова, что на сегодня MapInfo Professional &ndash; одна из ведущих ГИС, задействованная в любой сфере, где применяются карты. А, стало быть, и требования к ней предъявляются сообразные решаемым задачам.
		</p>
		<p>
			Безусловно, необходимо оценить усилия компании ESTI Map, официального представителя владельца программы Pitney Bowes Software Inc. Помимо продаж, как таковых, ESTI Map занимается локализацией MapInfo и её технической поддержкой. В том числе, компания разработала и бесплатно предоставляет дополнительные средства оформления картографических материалов: условные знаки различных масштабов и стили линий для различных задач. Скачать эти и другие разработки можно как на старом сайте компании <a href="http://www.esti-map.ru/%D0%A1%D1%82%D0%B0%D1%82%D1%8C%D0%B8/%D0%93%D0%B5%D0%BE%D0%B4%D0%B5%D0%B7%D0%B8%D1%8F%D0%B8%D0%BA%D0%B0%D1%80%D1%82%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%8F/%D0%A3%D1%81%D0%BB%D0%BE%D0%B2%D0%BD%D1%8B%D0%B5%D0%B7%D0%BD%D0%B0%D0%BA%D0%B8%D0%B8%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D1%80%D1%8B/tabid/117/Default.aspx">www.esti-map.ru</a>, так и на новом <a href="http://www.mapinfo.ru/resources/utils">www.mapinfo.ru </a>.
		</p>
		<p>
			Однако, далеко не всегда предложенных вариантов достаточно. Так, к примеру, довольно часто необходимо показать границу двухцветной линией. Или же &ndash; в моей практике был случай, когда для оформления требовалась линии с нанесёнными на них геометрическими фигурами: квадратами, треугольниками и кругами. Понятно, что никакой готовый набор не сможет удовлетворить все возможные запросы. Понятно, что необходимо иметь возможность оперативно изменять набор стилей линий в угоду конкретному случаю.
		</p>
		<p>
			Подобным же образом обстоят дела и с условными знаками, и с заливками. Но в данной статье разговор пойдет именно о редактировании стилей линий MapInfo.
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--2-->
		<h2 id="ch2">Стили линий MapInfo</h2>
		<p>
			Стиль линии, в терминологии MapInfo &ndash; это отображаемый на экране и на выводимый на печать вид линейных объектов и границ регионов. Задание пользователем стиля линии происходит выбором соответствующей иконки в списке стилей:
		</p>
		<img src="lstyle/1.png" alt="Рис. 1" width="398px" height="434px" />
		<p>
			Определения стилей линий описаны в файле mapinfow.pen. Файл может располагаться как в каталоге программы, так и в пользовательском каталоге. Уточнить месторасположение файла можно, выполнив в окне MapBasic (меню <i>Настройка &rarr; Показать окно MapBasic</i>) следующую конструкцию:
		</p>
		<p class="code">
	Note LocateFile$( 3 )
		</p>
		<img src="lstyle/2.png" alt="Рис. 2" width="219px" height="118px" />
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--3-->
		<h2 id="ch3">Программа MILISTED</h2>
		<p>
			Для редактирования файла определений стилей линий MapInfo используется программа MILISTED (она же Line Style Editor). Программа обычно поставляется вместе с установочным диском. Отдельно её можно скачать на <a href="http://www.pbinsight.com/support/product-downloads/item/line-style-editor" title=" www.pbinsight.com"> сайте компании Pitney Bowes</a>.
		</p>
		<p>
			Однако на сайте программа выложена в &laquo;урезанном&raquo; виде, без справки и файлов поддержки. Ниже предложены полные версии программы:
		</p>
		<ul>
			<li><a href="lstyle/lineedit.zip" title="Загрузить на этом сайте">Инсталляция с установочного диска (957 KB)</a></li>
			<li><a href="lstyle/milisted_20.zip" title="Загрузить на этом сайте">Распакованная (портабельная) версия программы (332 KB)</a></li>
		</ul>
		<p>
			Также дополнительно можно скачать <a href="lstyle/lineedit_UG.zip" title="Загрузить на этом сайте">Руководство Пользователя программы Line Style Editor (200 KB)</a>.
		</p>
		<p>
			Программа разработана ещё в 1996-1998 гг и с тех пор не модернизировалась. Несмотря на то, что разработчики (Independent Programmers Group) вполне себе из Украины, программа полностью англоязычна. Русскоязычной версии программы, похоже, не существует. Однако, программа довольно проста и разобраться с ней не составит особого труда.
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--4-->
		<h2 id="ch4">Меры предосторожности</h2>
		<p>
			Прежде чем начинать работу, необходимо учесть следующие моменты:
		</p>
		<ol>
			<li>Редактировать файл mapinfow.pen (да и, в целом, любой файл) &laquo;на живую&raquo; крайне неосмотрительно. Изменения, внесённые в файл, отменить невозможно. Поэтому настоятельно рекомендуется перед внесением изменений сделать резервную копию исходного файла.</li>
			<li>MapInfo не поддерживает редактирование файлов ресурсов (включая файл определений стилей линий) &laquo;на горячую&raquo;. Все параметры считываются исключительно при запуске программы. Таким образом, изменения, внесенные в файл mapinfow.pen применятся только после перезапуска ГИС.</li>
			<li>Файл определений стилей линий, формат которого не менялся со времен MapInfo версии 4.0, может содержать до 256 записей включительно. Однако, современные версии ГИС поддерживают только 128 записей (причём доступны пользователю будут только 127 первых записей). Превышение количества записей (стилей линий) в файле mapinfow.pen приведет к ошибке при запуске MapInfo.</li>
		</ol>
		<img src="lstyle/3.png" alt="Рис. 3" width="371px" height="119px" />
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--5-->
		<h2 id="ch5">Начало работы</h2>
		<p>
			Главное окно программы MILISTED оформлено в духе лучших традиций прикладного программирования 90-х. Аскетичный, даже минималистичный интерфейс: строка меню, короткая панель инструментов и строка статуса.
		</p>
		<img src="lstyle/4.png" alt="Рис. 4" width="560px" height="357px" />
		<p>
			На момент загрузки и открытия файла определений большая часть кнопок панели инструментов неактивна. Для того, чтобы начать работу по изменению стиля, необходимо выбрать требуемую позицию в рабочем окне и выполнить команду меню <i>Edit &rarr; Modify (Enter)</i>. Откроется новое окно редактирования выбранного стиля, инструменты на панели активизируются.
		</p>
		<img src="lstyle/5.png" alt="Рис. 5" width="482px" height="193px" />
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--6-->
		<h2 id="ch6">Обзор инструментов</h2>
		<p>
			Ниже представлен обзор Панели Инструментов программы MILISTED.
		</p>
		<table class="content">
			<tr>
				<td>
					<img src="lstyle/6-1.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					New
				</td>
				<td>
					Новый файл
				</td>
				<td>
					CTRL+N
				</td>
				<td>
					Создаёт новый файл определений .PEN
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-2.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Open
				</td>
				<td>
					Открыть файл
				</td>
				<td>
					CTRL+O
				</td>
				<td>
					Открывает существующий файл определений *.PEN в новом окне. Можно открывать несколько файлов *.PEN одновременно. Переключение между окнами осуществляется опциями меню Window.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-3.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Save
				</td>
				<td>
					Сохранить файл
				</td>
				<td>
					CTRL+S
				</td>
				<td>
					Сохраняет активный файл определений под текущим именем. Если файл только что создан и ещё не имеет имени, будет выведен диалог &laquo;Сохранить как&hellip;&raquo;
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-4.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Cut
				</td>
				<td>
					Вырезать
				</td>
				<td>
					CTRL+X
				</td>
				<td>
					Вырезает выделенный элемент в буфер обмена программы. Эта команда работает на уровне стилей линий и слоёв, но не применима к элементарным объектам, таким как Линия, Штрих и т.д.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-5.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Copy
				</td>
				<td>
					Копировать
				</td>
				<td>
					CTRL+C
				</td>
				<td>
					Копирует выделенный элемент в буфер обмена программы. Эта команда работает на уровне стилей линий и слоёв, но не применима к элементарным объектам, таким как Линия, Штрих и т.д.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-6.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Paste
				</td>
				<td>
					Вставить
				</td>
				<td>
					CTRL+V
				</td>
				<td>
					Вставляет элемент из буфера обмена программы. Эта команда работает на уровне стилей линий и слоёв, помещая вставленное в конец списка.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-7.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Layer
				</td>
				<td>
					Новый слой
				</td>
				<td>
					&nbsp;
				</td>
				<td>
					Создаёт новый слой в поле редактируемого стиля. Слой помещается после существующих.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-8.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Draw
				</td>
				<td>
					Отрезок
				</td>
				<td>
					-
				</td>
				<td>
					Создаёт новый горизонтальный отрезок в существующем слое. Длина отрезка ограничена длиной слоя.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-9.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Tick Mark
				</td>
				<td>
					Штрих
				</td>
				<td>
					|
				</td>
				<td>
					Создаёт новый вертикальный отрезок в существующем слое. Длина отрезка ограничена высотой слоя.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-10.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Andletrick &lt;
				</td>
				<td>
					Левый штрих
				</td>
				<td>
					&lt;
				</td>
				<td>
					Создаёт новую ломаную линию в виде знака &laquo;&lt;&raquo;. Центральный угол ломаной совпадает с горизонтальной осью слоя. При сокращении высоты может образовать отрезок с углом наклона 45&deg;.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-11.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Andletrick &gt;
				</td>
				<td>
					Правый штрих
				</td>
				<td>
					&gt;
				</td>
				<td>
					Создаёт новую ломаную линию в виде знака &laquo;&gt;&raquo;. Центральный угол ломаной совпадает с горизонтальной осью слоя. При сокращении высоты может образовать отрезок с углом наклона 45&deg;.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-12.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Polygon begin
				</td>
				<td>
					Полигон
				</td>
				<td>
					;
				</td>
				<td>
					Создаёт полигон в текущем слое. Полигон имеет 4 грани, вертикальные грани могут менять положение и размер.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-13.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Polygon tick
				</td>
				<td>
					Узлы полигона
				</td>
				<td>
					:
				</td>
				<td>
					Добавляет пару узлов на горизонтальные грани активного полигона. Вертикальная грань может менять положение и размер.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-14.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Polyline begin
				</td>
				<td>
					Полилиния
				</td>
				<td>
					,
				</td>
				<td>
					Создаёт полилинию в текущем слое. Полилиния имеет 2 узла, каждый из которых может изменять своё положение.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-15.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Polyline tick
				</td>
				<td>
					Узлы полилинии
				</td>
				<td>
					.
				</td>
				<td>
					Добавляет узел на активную полилинию. Узел может менять своё положение.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-16.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Draw to End
				</td>
				<td>
					Рисовать-До-Конца
				</td>
				<td>
					&nbsp;
				</td>
				<td>
					Создаёт видимую прямую в текущем слое, смещая все объекты, расположенные после, в конец линии. Положение прямой совпадает с горизонтальной осью слоя.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-17.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Skip to End
				</td>
				<td>
					Пропустить-До-Конца
				</td>
				<td>
					&nbsp;
				</td>
				<td>
					Создаёт НЕвидимую прямую в текущем слое, смещая все объекты, расположенные после, в конец линии. Положение прямой совпадает с горизонтальной осью слоя.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-18.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Loop
				</td>
				<td>
					Разрыв
				</td>
				<td>
					&nbsp;
				</td>
				<td>
					Запрещает повторение объектов текущего слоя, расположенных до элемента Стоп.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-19.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Draw Tool
				</td>
				<td>
					Свойства оформления
				</td>
				<td>
					&nbsp;
				</td>
				<td>
					Добавляет на текущий слой невидимый объект, позволяющий задать расширенные свойства оформления элементов слоя.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-20.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					About
				</td>
				<td>
					О программе
				</td>
				<td>
					&nbsp;
				</td>
				<td>
					Показывает окно с информацией о программе.
				</td>
			</tr>
			<tr>
				<td>
					<img src="lstyle/6-21.png" alt="Рис. 6" width="22px" height="23px" />
				</td>
				<td>
					Help
				</td>
				<td>
					Справка
				</td>
				<td>
					F1
				</td>
				<td>
					Вызывает справку программы в формате Windows Help (*.HPL)
				</td>
			</tr>
		</table>
		<p>
			Все инструменты Панели дублирует опции и команды меню программы. Дальнейшие пояснения будут приводиться с командами меню.
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--7-->
		<h2 id="ch7">Основные операции</h2>
		<h3>Иерархия элементов</h3>
		<p>
			Для успешной работы с программой MILISTED требуется чётко представлять себе иерархию элементов определений стилей линий.
		</p>
		<p>
			Самым верхним уровнем является сам файл определений *.PEN. С ним производятся все доступные файловые операции: копирование, удаление, открытие/закрытие файла.
		</p>
		<p>
			Ниже по уровню расположен список стилей линий. Именно окно списка стилей в программе MILISTED служит представлением файла *.PEN. Никаких манипуляций со списком в пределах программы производить нельзя, можно только получить его свойства &ndash; количество записей и их порядковые номера.
		</p>
		<p>
			Следующим уровнем, подлежащим списку, является сам стиль линии. На этом уровне возможно создание/удаление стилей, а также их копирование/вставка. Созданные/скопированные элементы списка стилей (стили) помещаются в конец списка.
		</p>
		<p>
			Каждый стиль, в свою очередь, раскладывается на слои. Со слоями стиля производятся стандартные манипуляции создания и удаления, копирования и вставки. Также возможно редактирование свойств слоя: размер, положение и порядок отображения.
		</p>
		<p>
			Слой содержит дочерние элементы стиля &ndash; объекты. Объекты бывают сложные (полигон, полилиния) и элементарные (прямая, отрезок).
		</p>
		<p>
			Таким образом, общая схема создания стиля линии выглядит так:
		</p>
		<ul>
			<li>Открыть файл *.PEN для редактирования.</li>
			<li>Добавить в списке стилей новый стиль.</li>
			<li>Открыть созданный стиль для редактирования.</li>
			<li>Добавить новый слой в стиль.</li>
			<li>Добавить на слой новые объекты.</li>
			<li>Сохранить файл *.PEN.</li>
		</ul>
		<h3>Создание нового файла определений стилей</h3>
		<p>
			Для создания нового файла определений стилей линий MapInfo необходимо выполнить команду &laquo;Новый файл&raquo; (меню <i>File &rarr; New</i>). В результате будет создан новый файл определений, содержащий 3 стиля по умолчанию. Из этих трех стилей первый является служебным и не подлежит редактированию, второй &ndash; соответствует стилю &laquo;N &ndash; без оформления&raquo; в диалоге выбора стилей ГИС MapInfo.
		</p>
		<img src="lstyle/7.png" alt="Рис. 7" width="560px" height="362px" />
		<p>
			Для записи файла на диск необходимо выполнить его сохранение командой &laquo;Сохранить файл&raquo; (меню <i>File &rarr; Save</i>). В приведённом примере файл сохранялся под именем test.PEN.
		</p>
		<h3>Открытие существующего файла определения стилей</h3>
		<p>
			Программа MILISTED мультиоконна, т. е. поддерживает одновременную работу с несколькими файлами определений.
		</p>
		<p>
			Для открытия существующего файла определений стилей необходимо выполнить команду &laquo;Открыть файл&raquo; (меню <i>File &rarr; Open</i>) и в стандартном диалоге указать путь к редактируемому файлу.
		</p>
		<img src="lstyle/8.png" alt="Рис. 8" width="560px" height="362px" />
		<h3>Создание и удаление стиля</h3>
		<p>
			Для создания нового стиля необходимо выполнить команду меню <i>Edit &rarr; New Line Style</i>. Эта команда будет доступна только при активном окне списка стилей. При активном окне, к примеру, слоя стиля, состав меню &laquo;Правка&raquo; будет иным.
		</p><img src="lstyle/9.png" alt="Рис. 9" width="560px" height="362px" />
		<p>
			В результате выполнения команды будет создан новый стиль, содержащий один пустой слой. Стиль будет помещен в конец списка стилей редактируемого файла определений.
		</p>
		<p>
			Для удаления стиля необходимо выбрать его в списке стилей окна определений и выполнить команду меню <i>Edit &rarr; Delete</i>. Команда Delete универсальна и, не меняясь в зависимости от активного окна, удаляет выделенный объект.
		</p>
		<h3>Копирование стиля</h3>
		<p>
			Стили можно копировать как в пределах одного файла определений, так и между файлами. Для того, чтобы скопировать (переместить) стиль необходимо выбрать стиль в списке стилей и выполнить команду &laquo;Копировать&raquo; или &laquo;Вырезать&raquo; (меню <i>Edit &rarr; Copy/Cut</i>). После помещения стиля в буфер обмена нужно активировать окно редактируемого файла определений и выполнить команду &laquo;Вставить&raquo;. Вставленный стиль будет помещен в конец списка стилей. В случае, если активное окно отличается от окна списка стилей, команда &laquo;Вставить&raquo; будет недоступна.
		</p>
		<img src="lstyle/10.png" alt="Рис. 10" width="460px" height="176px" />
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--8-->
		<h2 id="ch8">Работа со слоями</h2>
		<p>
		Основным элементом стиля линии является слой. По сути, стилей без слоёв не существует, даже неотображаемые стили (позиции списка 0 и 1) всё равно содержат один слой. И, если стиль &ndash; это контейнер, который содержит слои, то сам слой &ndash; это контейнер для объектов (линии, штрихи, полигоны etc).
		</p>
		<p>
			Кроме того, слой отвечает за размер элементов и их воспроизводимость. На этих двух моментах следует остановиться подробнее.
		</p>
		<p>
			Рабочее поле слоя линии в окне редактирования расчерчено на клетки. По умолчанию слой создаётся с размером 1×9 клеток. Впоследствии этот размер можно изменить при помощи указателя мыши или в окне свойств слоя (меню <i>Edit &rarr; Property</i>):
		</p>
		<img src="lstyle/11.png" alt="Рис. 11" width="225px" height="418px" />
		<p>
			Как известно из Руководства Пользователя (Line Style Editor 2.0 User Guide), толщина простой линии равна 1 пикселю (px). Так как линия занимает 1 клетку, можно сделать вывод, что размер клетки рабочего поля слоя &ndash; 1 px. Таким образом, минимальный размер рабочего поля составляет 1×9 px, максимальный &ndash; 31×128 px. Необходимо учитывать, что в поля длины и отступов от центра можно ввести значения 0-127 (для длины) и 4-15 (для отступов).
		</p>
		<p>
			Очевидно, что эти же значения являются максимальными и для объектов слоя.
		</p>
		<p>
			С длиной слоя напрямую связано понятие воспроизводимости объектов. Комплекс объектов, расположенных на слое, повторяется по всей линии, формируя её оформление. Пример конечного оформления линии можно увидеть в процессе редактирования в верхнем поле.
		</p>
		<img src="lstyle/12.png" alt="Рис. 12" width="460px" height="176px" />
		<p>
			Слоёв в стиле может быть больше одного, при этом самый нижний слой в окне редактирования стиля будет отображаться самым верхним в конечном оформлении линии. Воспроизводимость слоёв в стиле регулируется исключительно их собственным размером, т. е. слои воспроизводятся независимо.
		</p>
		<p>
			Со слоями стиля возможно выполнять все стандартные операции редактирования: создание (меню <i>Edit &rarr; New Layer</i>), удаление (меню <i>Edit &rarr; Delete</i>), копирование/вставка, а также изменение размеров (меню <i>Edit &rarr; Property</i>).
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--9-->
		<h2 id="ch9">Работа с объектами</h2>
		<p>
			Как уже упоминалось, объекты стиля линии подразделяются на элементарные и сложные. Элементарные объекты могут изменять свое расположение на слое, свой размер, но не могут изменять форму. Сложные же обладают дополнительными свойствами и разделяются на объекты формы и объекты смещения. К элементарным объектам относятся: Draw (Отрезок), Tick Mark (Штрих), Andletrick (Левый и Правый штрих). К сложным объектам формы относятся: Polygon (Полигон) и Polyline (Полилиния). Эти объекты могут менять не только размер и положение в целом, но и местоположение отдельных узлов (форму объекта). К объектам смещения относятся: Draw (Рисовать-До-Конца) и Skip (Пропустить-До-Конца). Объекты смещения регулируют местоположение других объектов слоя, расположенных после (правее) них. Кроме перечисленных, существуют, условно говоря, &laquo;служебные&raquo; элементы: , Loop (Разрыв) и Draw Tool (Свойства оформления). Последние не формируют каких-либо видимых на конечной линии элементов, но задают параметры оформления объектов в целом.
		</p>
		<h3>Основные операции редактирования</h3>
		<p>
			Для размещения элементов на слое необходимо выполнить команду меню <i>Edit &rarr; New Object &rarr; &hellip;</i> , либо выбрать требуемый элемент на Панели Инструментов. Элемент будет добавлен в активный слой стиля, непосредственно на или правее последнего активного объекта. В случае, когда объекты на слое отсутствуют, новый объект будет добавлен на первый пиксель горизонтальной оси слоя.
		</p>
		<p>
			Для удаления объекта необходимо активировать его указателем мыши или командой меню <i>Objects &rarr; Next/Previous</i>, а затем удалить командой меню <i>Edit &rarr; Delete</i>.
		</p>
		<p>
			Копирование объектов, к сожалению, в программе MILISTED запрещено.
		</p>
		<p>
			Изменение размеров объектов осуществляется аналогично со слоями: указателем мыши или командой меню <i>Edit &rarr; Property</i> для активного объекта:
		</p>
		<img src="lstyle/13.png" alt="Рис. 13" width="460px" height="226px" />
		<h3>Редактирование объектов формы</h3>
		<p>
		Сложный объект создаётся так же, как и прочие: командой меню или кнопкой на Панели Инструментов. После добавления сложного объекта на слой активизируются команды &laquo;Узлы полигона&raquo; или &laquo;Узлы полилинии&raquo; для полигона и полилинии соответственно.
		</p>
		<p>
			Последующее редактирование требует активации не самих объектов, а их узлов. Так, для изменения положения и размеров полигона необходимо последовательно изменить местоположение всех его узлов.
		</p>
		<img src="lstyle/14.png" alt="Рис. 14" width="460px" height="167px" />
		<p>
			Добавление узлов на активный сложный объект выполняется командой меню <i>Edit &rarr; New Object &rarr; Polygon/Polyline Tick</i>. При добавлении новых узлов длина объекта автоматически увеличивается на 1 пиксель вправо от добавления.
		</p>
		<img src="lstyle/15.png" alt="Рис. 15" width="460px" height="176px" />
		<h3>Использование объектов смещения</h3>
		<p>
			Объект Draw to End (Рисовать-До-Конца), создаёт прямую линию в активном слое. Но, в отличие от схожего с ним объекта Draw (Отрезок), не может менять свою длину. Являясь в геометрическом смысле лучом, Draw to End продолжается по всей длине линии. Особенность этого объекта заключается в том, что остальные объекты слоя, расположенные после него, сдвигаются в конец результирующей линии.
		</p>
		<img src="lstyle/16.png" alt="Рис. 16" width="460px" height="154px" />
		<p>
			Следующий объект этой группы, Skip to End (Пропустить-До-Конца), так же, как и предыдущий, создаёт в слое прямую линию, но на этот раз &ndash; невидимую. По сути, объект сдвигает все элементы слоя, расположенные правее него, в конец линии.
		</p>
		<img src="lstyle/17.png" alt="Рис. 17" width="460px" height="154px" />
		<h3>Использование служебных объектов</h3>
		<p>
			Первый из &laquo;служебных&raquo; объектов &ndash; Loop (Разрыв) &ndash; прекращает воспроизведение объектов, расположенных на слое слева от него. С известным допущением можно сказать, что Loop делит слой на два независимых по признаку воспроизведения слоя.
		</p>
		<img src="lstyle/18.png" alt="Рис. 18" width="460px" height="154px" />
		<p>
			Второй же объект, Draw Tool (Свойства оформления) является, пожалуй, самым интересным. При добавлении этого объекта на слой ничего не происходит. Но если его активировать и открыть свойства, то появится окно, позволяющее менять свойства оформления всех объектов, добавленных после.
		</p>
		<img src="lstyle/19.png" alt="Рис. 19" width="453px" height="170px" />
		<p>
			В окне выделяются 4 блока опций:
		</p>
		<ul>
			<li>Pen Width (Толщина линии)</li>
			<li>Pen Color (Цвет линии)</li>
			<li>Pen Width Limits (Предел толщины линии)</li>
			<li>Brush Color (Цвет заливки)</li>
		</ul>
		<p>
			Pen Width отвечает за толщину линий создаваемых в слое объектов. По умолчанию выставлена опция &laquo;User&raquo; (Пользовательская). Это наиболее распространённая ситуация, при которой толщина объектов при создании будет равной 1 px, а в дальнейшем, при использовании стиля в MapInfo, к этой толщине будут добавляться пользовательские настройки. Опция &laquo;User +&raquo; изменяет толщину линии при её создании. Таким образом, можно создать линию с толщиной до 7 px. При использовании такого стиля в MapInfo пользовательские настройки будут также добавляться к исходной толщине. Опция &laquo;Own&raquo; позволяет выставить собственные настройки толщины линии, которые будут неизменны в среде MapInfo. Т.е., если создать стиль с линий толщиной 1 px, то и в конечной карте эта линия будет однопиксельной, вне зависимости от настроек оформления. Опция же &laquo;Not used&raquo; отменяет действие предыдущих объектов Draw Tools (при условии, что их на слое несколько).
		</p>
		<p>
			Pen Color регулирует цвет линии объектов. Так же как и в предыдущем блоке, опция &laquo;Not used&raquo; отменяет действие предыдущих объектов Draw Tools, опция &laquo;User&raquo; оставляет право выбора цвета за пользователем, а &laquo;Own&raquo; жёстко фиксирует неизменное значение цвета линии.
		</p>
		<p>
			Pen Width Limits устанавливает пределы, в которых может изменяться толщина линии. Ввести можно значения от 0 до 7, но это &ndash; не толщина линии собственно, т. к. линия не может быть меньше 1 px. Эти значения регламентируют то, на сколько можно изменять толщину линии.
		</p>
		<p>
			Brush Color регулирует цвет заливки для полигонов. Действие опций полностью аналогично блоку Pen Color.
		</p>
		<p>
			Важным моментов при использовании Draw Tools является положение других объектов относительно него. Draw Tools будет влиять только на те объекты, которые расположены после (правее) него. То же касается и Skip to End, и Loop, и других. Но, если тот же Loop не получится переместить относительно предыдущих объектов, то Draw Tools не столь нативен. Чтобы избежать ошибки, требуется внимательно следить за его положением.
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--10-->
		<h2 id="ch10">Инвариантность результатов</h2>
		<p>
			Особенностью создания стилей оформления линии MapInfo является тот занятный факт, что одинакового с виду результата можно достичь несколькими способами. Так, сплошную линию можно создать, добавив на слой объект Draw to End (Рисовать-До-Конца), а можно при помощи объекта Draw (Отрезок). При этом последний можно создать как однопиксельный, так и многопиксельный &ndash; результат конечного оформления будет визуально неотличим.
		</p>
		<p>
			Объекты можно располагать на одном слое, а можно на разных. Наклонный отрезок можно создать при помощи объекта Angletick, а можно изобразить его полилинией.
		</p>
		<p>
			В общем и целом, при равенстве результатов, выбор инструмента в каждом конкретном случае &ndash; дело исключительно личных предпочтений.
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--11-->
		<h2 id="ch11">Соблюдение размеров</h2>
		<p>
			Как уже говорилось, MapInfo не является программой для предпечатной подготовки карт, это ГИС, со своими сильными и слабыми сторонами. Однако, если уж жизнь и работа заставляют соблюдать некие правила оформления линейных объектов, то следует озаботиться и их соответствиям размерам в масштабе.
		</p>
		<p>
			Пусть не полностью, пусть не совсем удобно, но стили линий MapInfo позволяют соблюдать это требование. К сожалению, создать стиль линий, выдержанный в размерах, можно только под определённый масштаб и для комфортной работы придётся иметь набор файлов *.PEN, но это всё равно больше, чем ничего.
		</p>
		<p>
			Итак, линии в MapInfo (и MILISTED) измеряются в пикселях. Размер пикселя, как известно, напрямую зависит от разрешения изображения. Внутреннее разрешение MapInfo равняется 96 DPI. Таким образом, размер пикселя для MapInfo составляет:
		</p>
		<p class="code">
	1 дюйм / 96 DPI = 25,4 мм / 96 DPI = 0,26458(3) мм &asymp; 0,265 мм
		</p>
		<p>
			Исходя из этого, можно создавать элементы слоя, которые будут более-менее соответствовать требованиям в определённом масштабе.
		</p>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--12-->
		<h2 id="ch12">Практические примеры</h2>
		<h3>ЛЭП в масштабе</h3>
		<p>
			Задача: создать стиль линии, отображающий условный знак 115(3) &laquo;ЛЭП высокого напряжения&raquo; для масштаба 1:5000.
		</p>
		<p>
			Рассчитываем размер элементов для знака (в масштабе):
		</p>
		<ul>
			<li>длина стрелки 3-4 мм соответствует 11-15 px;</li>
			<li>высота указателя стрелки 1 мм соответствует 3-4 px;</li>
			<li>расстояние между указателями 0,2 мм соответствует 1 px;</li>
			<li>диаметр знака столба 1 мм соответствует 3-4 px.</li>
		</ul>
		<p>
			Руководствуясь этими размерами, создаём стиль:
		</p>
		<ul>
			<li>Создаём новый стиль.</li>
			<li>Создаем слой 1 длиной 6 px. На нём размещаем Draw Tools и запрещаем изменение толщины и цвета. Добавляем Draw to End на позицию 3.</li>
			<li>Создаём слой 2 длиной 19 px. На нём размещаем Draw Tools и запрещаем изменение толщины и цвета. Добавляем два Angletick c отступами 3/-2 на позиции 16 и 18. Добавляем Loop на позицию 19.</li>
			<li>Создаём слой 3 длиной 19 px. На нём размещаем Draw Tools и запрещаем изменение толщины и цвета. Добавляем Skip to End на позицию 0. Добавляем два Angletick c отступами 3/-2 на позиции 1 и 13.</li>
		</ul>
		<table>
			<tr>
				<td><img src="lstyle/20-1.png" alt="Рис. 20" width="190px" height="300px" /></td>
				<td><img src="lstyle/20-2.png" alt="Рис. 20" width="410px" height="300px" /></td>
			</tr>
		</table>
		<h3>Зимник в масштабе</h3>
		<p>
			Задача: создать стиль линии, отображающий условный знак 194 &laquo;Зимник&raquo; для масштаба 1:5000.
		</p>
		<p>
			Рассчитываем размер элементов для знака (в масштабе):
		</p>
		<ul>
			<li>длина вспомогательного штриха 3 мм соответствует 11-12 px;</li>
			<li>длина промежутка меду штрихами 2 мм соответствует 6-7 px;</li>
			<li>расстояние между осями 1,3 мм соответствует 5 px;</li>
			<li>длина основного штриха (3+2+3)=8 мм соответствует 30 px.</li>
		</ul>
		<p>
			Руководствуясь этими размерами, создаём стиль:
		</p>
		<ul>
			<li>Создаём новый стиль.</li>
			<li>Создаем слой 1 длиной 36 px. На нём размещаем Draw Tools и запрещаем изменение толщины и цвета. Добавляем Polyline Begin с координатами (0, -3) &ndash; (30, -3).</li>
			<li>Создаём слой 2 длиной 36 px. На нём размещаем Draw Tools и запрещаем изменение толщины и цвета. Добавляем Polyline Begin с координатами (0, 3) &ndash; (12, 3). Добавляем Polyline Begin с координатами (19, 3) &ndash; (30, 3).</li>
		</ul>
		<table>
			<tr>
				<td><img src="lstyle/21-1.png" alt="Рис. 21" width="326px" height="224px" /></td>
				<td><img src="lstyle/21-2.png" alt="Рис. 21" width="274px" height="224px" /></td>
			</tr>
		</table>
		<h3>Двухцветная линия</h3>
		<p>
			Задача: создать стиль линии, сочетающий сплошные линии красного и синего цвета.
		</p>
		<p>
			Линия должна быть масштабируемой, поэтому расчёт размеров не производим.
		</p>
		<p>
			Создаём стиль:
		</p>
		<ul>
			<li>Создаём новый стиль.</li>
			<li>Создаем слой 1. На нём размещаем Draw Tools и выставляем Pen Color в значение белого цвета. Добавляем Draw to End.</li>
			<li>Создаём слой 2. На нём размещаем Draw Tools и выставляем Pen Color в значение красного цвета. Добавляем Polyline с координатами Y = 1.</li>
			<li>Создаём слой 3. На нём размещаем Draw Tools и выставляем Pen Color в значение синего цвета. Добавляем Polyline с координатами Y = -1.</li>
		</ul>
		<table>
			<tr>
				<td><img src="lstyle/22-1.png" alt="Рис. 22" width="128px" height="299px" /></td>
				<td><img src="lstyle/22-2.png" alt="Рис. 22" width="461px" height="300px" /></td>
			</tr>
		</table>
		<div class="split">
			<a href="#toc">К оглавлению &gt;&gt;&gt;</a>
			<hr />
		</div>

<!--13-->
		<h2 id="ch13">Список использованной литературы</h2>
		<ul>
			<li><a href="lstyle/mapinfow_pen_original.zip" title="Загрузить файл mapinfow.PEN">Оригинальный файл стиля линий mapinfow.PEN</a></li>
			<li><a href="lstyle/lineedit_UG.zip" title="Загрузить Руководство Пользователя">&laquo;Line Style Editor 2.0 User Guide&raquo;, Pitney Bowes Software Inc., 2010</a></li>
			<li><a href="http://georezo.net/jparis/MI_Enviro/Lines/offset_lines.htm" title="Перейти на сайт">&laquo;Offset lines in MapInfo&raquo;, Jacques Paris, 2002</a></li>
			<li><a href="http://gis-lab.info/forum/viewtopic.php?f=17&amp;t=4167" title="Перейти на сайт">Форумы GIS-Lab.info</a></li>
			<li><a href="http://en.wikipedia.org/wiki/MapInfo_Professional" title="Перейти на сайт">MapInfo Professional From Wikipedia</a></li>
		</ul>

	</div>
</div></div></div></div>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
	(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
	m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
	(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
 
	ym(86922484, "init", {
		 clickmap:true,
		 trackLinks:true,
		 accurateTrackBounce:true
	});
 </script>
 <noscript><div><img src="https://mc.yandex.ru/watch/86922484" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
 <!-- /Yandex.Metrika counter -->

</body>
</html>